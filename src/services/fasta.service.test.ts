import { describe } from "node:test";
import * as fastaService from "./fasta.service";

describe("fasta - parseFastaFile", () => {
  it("should return multiple sequences", () => {
    expect(fastaService.parseFastaFile(fastFileMock)).toStrictEqual([
      {
        sequenceName: "ExampleSeq1",
        sequence:
          "GAACCAACTCAAGTCAACGAGTCGACCAAGAAGGGAGTAAATAATAGCCGTTGGTGAGTTAGCTCGTGCTTAAGTTACTGGTGTTAGGCCTGAAACTGGTTTTATTCTCTTTGGTGTTAATGTTTCCTTCTTCCTCAGTTTCTCAGAGATACGTCGGAAGTGGGAAGAAGAACTCTATGAAGAGCTTGAGAGGCATCGAGGTAAGTGTTATTTCTTCAAGACTAAAGATTTGAAGAAAATGACTTAAAATTTGTACAAGCATTTGTTTACTAATAGTAAAACTCTTTGCAGAGAATCTGCGACACGCTGGTGCAGGAGGGAAGACTCCATTATCAGGCCACAAAGGATAGTGAACGGCTAAAGAGAAACTGTATGTTTCTTTCTTATGTTTCAAAATTACTTCGGAATAGGAACTGGTGGTACTGTAACTGGTACTGGAGGTTTCTTGAAAATGATGAACAAGGATATTAAGGTATTTCTCTTTCTCTTGTTTTCAGATTTCTGGTTTAACCTTGTGATTACCTTTATATGAAAGATCCTTAAAACATAGGTAGTTGGCGTTGAACCATCAGAAAGAAGTGTGATTTCTGGAGACAACCCTGGTAAGGAGCATTGAGGCTTCATGTCTTCAGAATCAATACTTTTGAATTGGGTTTATATGCTTTGGAATCCCCCTTACAAAATACTACTAAACGGTTTTTCAGGTTACTTACCGGGAATCTTGGATGTTAAATTACTTGATGAAGTGTTTAAGGTTAACAATACTTTCAAATCATAATCAACATTTCAAACGATACATCTATTGGCGGCGAAGGGGAGGTTGAAAGTGGTCGGAAGAGCCGGAGTTGGGATTGACAATGTTGATCTGCAGGCGGCGACGGAGCACGGGTGTTTGGTGGTTAATGCTCCAACGGCTAATACGGTGGCTGCTGCCGAACATGGAATTGCTTTGCTTGCTTCTATGGCACGTAACGTTGCTCAGGCCGACGCTTCTATTAAAGCCGGTACGTTCCCGGTTAGCCATTTTTTTTTTGTTTTATTGAAATGAGACATTTAACCAATTAACCTATCTAGATTAACTTAAAGCTTATACTATGTTTCACACCATGGAAAAGAAAAAACTAATCTAACATGTTTTAGTCTCGCAAAGATTACGAGATCTGATGAAGTCCAAATTATCTTGATTACAAAAAAGAAGAATTGATT",
      },
      {
        sequenceName: "ExampleSeq2",
        sequence:
          "GTATAAACTCACCATGTTCAAGAACGATCTCATGGCTGGTTTAACCCTCGCTAGCCTCTGCATTCCGCAGGTATATTATATACACAAAACTTAAAAATACTATTTTGATCCGTTTAAAGATCTTCTGAAATTCATTTTTTTTTTTTGTGTGTAGAGCATTGGTTATGCAACTCTTGCAAAGCTTGATCCTCAATATGGCCTATGTAAGTTTATTTTACATATTGAAATGATGATTTTTTTTTTCCTTCAAATAAAATTATAGTTTTTAATAACATGGAGCGTTACACTTTTACAGATACGAGTGTGGTACCACCATTGATATATGCATTGATGGGGACATCAAGAGAGATAGCAATCGGACCGGTGGCTGTAGTATCTCTTCTTATATCTTCAATGTTGCAGAAAACAGT",
      },
    ]);
  });
});

const fastFileMock = `
>ExampleSeq1
GAACCAACTCAAGTCAACGAGTCGACCAAGAAGGGAGTAAATAATAGCCGTTGGTGAGTTAGCTC
GTGCTTAAGTTACTGGTGTTAGGCCTGAAACTGGTTTTATTCTCTTTGGTGTTAATGTTTCCTTC
TTCCTCAGTTTCTCAGAGATACGTCGGAAGTGGGAAGAAGAACTCTATGAAGAGCTTGAGAGGCA
TCGAGGTAAGTGTTATTTCTTCAAGACTAAAGATTTGAAGAAAATGACTTAAAATTTGTACAAGC
ATTTGTTTACTAATAGTAAAACTCTTTGCAGAGAATCTGCGACACGCTGGTGCAGGAGGGAAGAC
TCCATTATCAGGCCACAAAGGATAGTGAACGGCTAAAGAGAAACTGTATGTTTCTTTCTTATGTT
TCAAAATTACTTCGGAATAGGAACTGGTGGTACTGTAACTGGTACTGGAGGTTTCTTGAAAATGA
TGAACAAGGATATTAAGGTATTTCTCTTTCTCTTGTTTTCAGATTTCTGGTTTAACCTTGTGATT
ACCTTTATATGAAAGATCCTTAAAACATAGGTAGTTGGCGTTGAACCATCAGAAAGAAGTGTGAT
TTCTGGAGACAACCCTGGTAAGGAGCATTGAGGCTTCATGTCTTCAGAATCAATACTTTTGAATT
GGGTTTATATGCTTTGGAATCCCCCTTACAAAATACTACTAAACGGTTTTTCAGGTTACTTACCG
GGAATCTTGGATGTTAAATTACTTGATGAAGTGTTTAAGGTTAACAATACTTTCAAATCATAATC
AACATTTCAAACGATACATCTATTGGCGGCGAAGGGGAGGTTGAAAGTGGTCGGAAGAGCCGGAG
TTGGGATTGACAATGTTGATCTGCAGGCGGCGACGGAGCACGGGTGTTTGGTGGTTAATGCTCCA
ACGGCTAATACGGTGGCTGCTGCCGAACATGGAATTGCTTTGCTTGCTTCTATGGCACGTAACGT
TGCTCAGGCCGACGCTTCTATTAAAGCCGGTACGTTCCCGGTTAGCCATTTTTTTTTTGTTTTAT
TGAAATGAGACATTTAACCAATTAACCTATCTAGATTAACTTAAAGCTTATACTATGTTTCACAC
CATGGAAAAGAAAAAACTAATCTAACATGTTTTAGTCTCGCAAAGATTACGAGATCTGATGAAGT
CCAAATTATCTTGATTACAAAAAAGAAGAATTGATT
>ExampleSeq2
GTATAAACTCACCATGTTCAAGAACGATCTCATGGCTGGTTTAACCCTCGCTAGCCTCTGCATTC
CGCAGGTATATTATATACACAAAACTTAAAAATACTATTTTGATCCGTTTAAAGATCTTCTGAAA
TTCATTTTTTTTTTTTGTGTGTAGAGCATTGGTTATGCAACTCTTGCAAAGCTTGATCCTCAATA
TGGCCTATGTAAGTTTATTTTACATATTGAAATGATGATTTTTTTTTTCCTTCAAATAAAATTAT
AGTTTTTAATAACATGGAGCGTTACACTTTTACAGATACGAGTGTGGTACCACCATTGATATATG
CATTGATGGGGACATCAAGAGAGATAGCAATCGGACCGGTGGCTGTAGTATCTCTTCTTATATCT
TCAATGTTGCAGAAAACAGT
`;
